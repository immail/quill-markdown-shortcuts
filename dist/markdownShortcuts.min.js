!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MarkdownShortcuts=e():t.MarkdownShortcuts=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var l,a=t[Symbol.iterator]();!(i=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){function t(e,n){var o=this;r(this,t),this.quill=e,this.options=n,this.ignoreTags=["PRE"],this.shortMatches=[{name:"short_bold",pattern:/(?:\*){1}(.+?)(?:\*){1}/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||(console.log("shortBold:",{annotatedText:l,matchedText:a,startIndex:u}),setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{bold:!0}),o.quill.format("bold",!1)},0))}},{name:"short_italic",pattern:/(?:\*|_){1}(.+?)(?:\*|_){1}/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{italic:!0}),o.quill.format("italic",!1)},0)}},{name:"short_strikethrough",pattern:/(?:~)(.+?)(?:~)/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{strike:!0}),o.quill.format("strike",!1)},0)}}],this.moreMatches=this.withShortMatches?[].concat(i(this.shortMatches)):[],this.matches=[{name:"bold",pattern:/(?:\*){2}(.+?)(?:\*){2}/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{bold:!0}),o.quill.format("bold",!1)},0)}},{name:"italic",pattern:/(?:\*|_){2}(.+?)(?:\*|_){2}/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{italic:!0}),o.quill.format("italic",!1)},0)}},{name:"strikethrough",pattern:/(?:~~)(.+?)(?:~~)/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{strike:!0}),o.quill.format("strike",!1)},0)}},{name:"code-block",pattern:/^`{3}(?:\s|\n)/g,action:function(t,e){setTimeout(function(){o.quill.formatLine(e.index,1,"code-block",!0),o.quill.deleteText(e.index-4,4)},0)}},{name:"code",pattern:/(?:`)(.+?)(?:`)/g,action:function(t,e,n,i){var r=n.exec(t),l=r[0],a=r[1],u=i+r.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){o.quill.deleteText(u,l.length),o.quill.insertText(u,a,{code:!0}),o.quill.format("code",!1),o.quill.insertText(o.quill.getSelection()," ")},0)}},{name:"plus-ul",pattern:/^\+\s$/g,action:function(t,e,n){setTimeout(function(){o.quill.formatLine(e.index,1,"list","unordered"),o.quill.deleteText(e.index-2,2)},0)}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))/g,action:function(t,e,n){var i=t.search(n),r=t.match(n)[0],l=t.match(/(?:\[(.*?)\])/g)[0],a=t.match(/(?:\((.*?)\))/g)[0],u=e.index-r.length-1;-1!==i&&setTimeout(function(){o.quill.deleteText(u,r.length),o.quill.insertText(u,l.slice(1,l.length-1),"link",a.slice(1,a.length-1))},0)}}].concat(i(this.shortMatches)),this.quill.on("text-change",function(t,e,n){for(var i=0;i<t.ops.length;i++)t.ops[i].hasOwnProperty("insert")&&([" ","*","~","_"].includes(t.ops[i].insert)?o.onSpace():"\n"===t.ops[i].insert&&o.onEnter())})}return l(t,[{key:"isValid",value:function(t,e){return void 0!==t&&t&&-1===this.ignoreTags.indexOf(e)}},{key:"onSpace",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=o(e,2),i=n[0],r=n[1],l=i.domNode.textContent,a=t.index-r;if(console.log({selection:t,line:i,lineStart:a}),this.isValid(l,i.domNode.tagName)){var u=!0,c=!1,s=void 0;try{for(var f,h=this.matches[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(l.match(d.pattern))return void d.action(l,t,d.pattern,a)}}catch(t){c=!0,s=t}finally{try{!u&&h.return&&h.return()}finally{if(c)throw s}}}}}},{key:"onEnter",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=o(e,2),i=n[0],r=n[1],l=i.domNode.textContent+" ",a=t.index-r;if(t.length=t.index++,this.isValid(l,i.domNode.tagName)){var u=!0,c=!1,s=void 0;try{for(var f,h=this.matches[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(l.match(d.pattern))return void d.action(l,t,d.pattern,a)}}catch(t){c=!0,s=t}finally{try{!u&&h.return&&h.return()}finally{if(c)throw s}}}}}}]),t}();window.Quill&&window.Quill.register("modules/markdownShortcuts",a),t.exports=a}])});