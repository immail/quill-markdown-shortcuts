!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MarkdownShortcuts=e():t.MarkdownShortcuts=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var u,l=t[Symbol.iterator]();!(i=(u=l.next()).done)&&(n.push(u.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=function(){function t(e,n){var r=this;o(this,t),this.quill=e,this.options=n,this.ignoreTags=["PRE"],this.shortMatches=[{name:"short_bold",pattern:/(?:\*){1}((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?)(?:\*){1}/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;console.log("short_bold::","text: "+t+", annotatedText: "+l+", matchedText: "+a+", startIndex: "+c+", matchIndex: "+u.index+", emojisLength: "+o),t.match(/^([\n \*_]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{bold:!0}),r.quill.format("bold",!1)},0)}},{name:"short_italic",pattern:/(?:\*|_){1}(.+?)(?:\*|_){1}/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{italic:!0}),r.quill.format("italic",!1)},0)}},{name:"short_strikethrough",pattern:/(?:~)(.+?)(?:~)/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{strike:!0}),r.quill.format("strike",!1)},0)}}],this.moreMatches=this.options.withShortMatches?[].concat(i(this.shortMatches)):[],this.matches=[].concat(i(this.moreMatches),[{name:"bold",pattern:/(?:\*|_){2}(.+?)(?:\*|_){2}/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{bold:!0}),r.quill.format("bold",!1)},0)}},{name:"italic",pattern:/(?:\*|_){1}(.+?)(?:\*|_){1}/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{italic:!0}),r.quill.format("italic",!1)},0)}},{name:"strikethrough",pattern:/(?:~~)(.+?)(?:~~)/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{strike:!0}),r.quill.format("strike",!1)},0)}},{name:"code-block",pattern:/^`{3}(?:\s|\n)/g,action:function(t,e){setTimeout(function(){r.quill.formatLine(e.index,1,"code-block",!0),r.quill.deleteText(e.index-4,4)},0)}},{name:"code",pattern:/(?:`)(.+?)(?:`)/g,action:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=n.exec(t),l=u[0],a=u[1],c=i+u.index-3*o;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(c,l.length),r.quill.insertText(c,a,{code:!0}),r.quill.format("code",!1),r.quill.insertText(r.quill.getSelection()," ")},0)}},{name:"plus-ul",pattern:/^\+\s$/g,action:function(t,e,n){setTimeout(function(){r.quill.formatLine(e.index,1,"list","unordered"),r.quill.deleteText(e.index-2,2)},0)}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))/g,action:function(t,e,n){var i=t.search(n),o=t.match(n)[0],u=t.match(/(?:\[(.*?)\])/g)[0],l=t.match(/(?:\((.*?)\))/g)[0],a=e.index-o.length-1;-1!==i&&setTimeout(function(){r.quill.deleteText(a,o.length),r.quill.insertText(a,u.slice(1,u.length-1),"link",l.slice(1,l.length-1))},0)}}]),this.quill.on("text-change",function(t,e,n){for(var i=0;i<t.ops.length;i++)t.ops[i].hasOwnProperty("insert")&&([" ","*","~","_"].includes(t.ops[i].insert)?r.onTriggers():"\n"===t.ops[i].insert?r.onEnter():t.ops[i].hasOwnProperty("delete")&&"user"===n&&r.onDelete())})}return u(t,[{key:"isValid",value:function(t,e){return void 0!==t&&t&&-1===this.ignoreTags.indexOf(e)}},{key:"onTriggers",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=r(e,2),i=n[0],o=n[1],u=i.domNode.textContent,l=t.index-o;if(this.isValid(u,i.domNode.tagName)){var a=!0,c=!1,s=void 0;try{for(var h,d=this.matches[Symbol.iterator]();!(a=(h=d.next()).done);a=!0){var f=h.value;if(u.match(f.pattern)){var m=u.match(this.emojisRegex())||[];return console.log({emojisFound:m}),void f.action(u,t,f.pattern,l,m.length)}}}catch(t){c=!0,s=t}finally{try{!a&&d.return&&d.return()}finally{if(c)throw s}}}}}},{key:"onEnter",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=r(e,2),i=n[0],o=n[1],u=i.domNode.textContent+" ",l=t.index-o;if(t.length=t.index++,this.isValid(u,i.domNode.tagName)){var a=!0,c=!1,s=void 0;try{for(var h,d=this.matches[Symbol.iterator]();!(a=(h=d.next()).done);a=!0){var f=h.value;if(u.match(f.pattern)){var m=[];return void f.action(u,t,f.pattern,l,m.length)}}}catch(t){c=!0,s=t}finally{try{!a&&d.return&&d.return()}finally{if(c)throw s}}}}}},{key:"onDelete",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getFormat(t);(e.blockquote||e.code||e["code-block"])&&(this.isLastBrElement(t)||this.isEmptyLine(t))&&this.quill.removeFormat(t.index,t.length)}}},{key:"isLastBrElement",value:function(t){var e=this.quill.scroll.descendant(Block,t.index),n=r(e,1),i=n[0];return null!=i&&i.domNode.firstChild instanceof HTMLBRElement}},{key:"isEmptyLine",value:function(t){var e=this.quill.getLine(t.index);return""===r(e,1)[0].children.head.text.trim()}},{key:"emojisRegex",value:function(){return/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g}}]),t}();window.Quill&&window.Quill.register("modules/markdownShortcuts",l),t.exports=l}])});